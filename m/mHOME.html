<!DOCTYPE html>
<html lang="en">
<head>

<!-- Basic Page Needs -->
    <meta charset="utf-8">
    <title>gap maps</title>
    <meta name="description" content="">
    <meta name="author" content="">

<!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- FONT -->
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

<!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/m.css">

<!-- Favicon -->
    <link rel="icon" type="image/png" href="images/favicon.png">

<!-- Leaflet -->
    <link rel ="stylesheet" href ="leaflet/leaflet.css" />
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="leaflet/leaflet.js"></script>
  
<!-- Mapbox -->
    <script src="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js"> </script>
    <link href="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css" rel='stylesheet' />

</head>

<body>

<!-- Primary Page Layout -->

<div class= "wrapper">
    <button href="/Users/Ruth/Desktop/Website/m/mHOME.html"><img src="images/sprite.png" alt="house" style ="width:15px; line-height: 10rem;  "></button>

    <button onclick="
        var geojson=L.geoJson(CDBoundary_simple,{
        style:style,
        onEachFeature: onEachFeature
        }).addTo(map);
        ">Summary</button>
    
    <button onclick="
        var geojson=L.geoJson(CDBoundary_simple,{
        style:styleSR65,
        onEachFeature: onEachFeature
        }).addTo(map);
        
        ">SR65</button>
    
    <button onclick="
        var geojson=L.geoJson(CDBoundary_simple,{
        style:styleSR80,
        onEachFeature: onEachFeature
        }).addTo(map);
        
        ">
        SR80</button>
    

</div>
<div id ='map'></div>
<script scr ="js/PopulatedPlaces_Canada.js"></script>


<script src ="js/CDBoundary_simple.js"></script>

<script>
    // Setting up custom mapbox basemap
  
    L.mapbox.accessToken =
        'pk.eyJ1IjoicnV0aGhhbm5haCIsImEiOiJjaWh6MW1sc2MwNDZidWhrb2F3NjkwcmtmIn0.-kBXpXiYaLRbz7Km3UWwEg';
    
    var southWest = L.latLng(30, -145),
        northEast = L.latLng(85, -50),
        bounds = L.latLngBounds(southWest, northEast);
    
    var map= L.mapbox.map('map','ruthhannah.97be37d0',
                          {maxBounds: bounds,})
                          .setView([64.696, -100.986], 3);
 
   

/////////////////////////////////////////////SUMMARY MAP

function style(feature){
    return {
        fillColor: '#FFFFFF',
        weight: 0.5,
        opacity: 1,
        color: '#bdbdbd',
        dashArray: '',
        fillOpacity:0.4
    };
}

/////////////////////////////////////////////SR65 Map
    function getColorSR65(d){
        return d> 93.160?'#08519c':
        d> 87.000 ?'#3182bd':
        d> 83.260?'#6baed6':
        d> 79.700?'#bdd7e7':
            '#eff3ff';
    }

/////////////////////////////////////////////
    function styleSR65(feature){
        return {
            fillColor: getColorSR65(feature.properties.SR65),
            weight: 0.5,
            opacity: 1,
            color: '#bdbdbd',
            dashArray: '',
            fillOpacity:0.4
        };
    }
/////////////////////////////////////////////SR80 Map
function getColorSR80(d){
    return d> 69.020?'#08519c':
    d> 63.360 ?'#3182bd':
    d> 59.380?'#6baed6':
    d> 55.640?'#bdd7e7':
    '#eff3ff';
}
/////////////////////////////////////////////
function styleSR80(feature){
    return {
        fillColor: getColorSR80(feature.properties.SR80),
        weight: 0.5,
        opacity: 1,
        color: '#bdbdbd',
        dashArray: '',
        fillOpacity:0.4
    };
}
////////////
    // Highlights census divisions
    function highlightFeature(e){
        var layer = e.target;
        info.update(layer.feature.properties);
        layer.setStyle({
            weight:1,
            color: '#737373',
            dashArray:'',
            fillOpacity:0.8
            });
                   
            if (!L.Browser.ie && !L.Browser.opera){
                layer.bringToFront();
                }
    }

    // Resets the census division highlight
    var geojson;
    
    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    function zoomToFeature(e){
        map.fitBounds(e.target.getBounds());
    }

    // Adds listeners to layer so that census divisions are highlighted and reset
    function onEachFeature (feature, layer){
        layer.on({
             mouseover:highlightFeature,
             mouseout:resetHighlight,
             click:zoomToFeature
             });
    }

    var geojson=L.geoJson(CDBoundary_simple,{
                      style:style,
                      onEachFeature: onEachFeature
                      }).addTo(map);

//////////////////////////////////////SUMMARY INFO
// When the mouse hovers the variables attached to each
// census division are shown in an info box when mouse hovers
    var info = L.control();

    info.onAdd = function(map) {
        this._div = L.DomUtil.create('div','info');
        this.update();
        return this._div;
    };

    info.update = function(props) {
        this._div.innerHTML = (props? '<b> Province</b>: '+ props.PRNAME : "")
        + (props? '<br/><b>Census Division</b>: '+ props.CDNAME : "")
        + (props? '<br /><b>Percent Over 65: </b>' + props.P65.toFixed(2)+ '%' : "")
        + (props? '<br /><b>Percent Over 80: </b>' + props.P80.toFixed(2) + '%' : "")
        + (props? '<br /><b>Sex Ratio 65: </b>' + props.SR65.toFixed(2) + '%' : "")
        + (props? '<br /><b>Sex Ratio 80:</b> ' + props.SR80.toFixed(2) + '%' : "")
        + (props? '<br /><b>Old Component Ratio: </b>' + props.ODR.toFixed(2) + '%': "");
        };

    info.addTo(map);
    


</script>

<!-- End Document -->
</body>
</html>
