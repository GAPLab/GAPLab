<!DOCTYPE html>
<html lang="en">
<head>

<!-- Basic Page Needs -->
    <meta charset="utf-8">
    <title>GAP Choropleth Maps</title>
    <meta name="description" content="">
    <meta name="author" content="">

<!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- FONT -->
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

<!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/m.css">

<!-- Favicon -->
    <link rel="icon" type="image/png" href="images/favicon.png">

<!-- Leaflet -->
    <link rel ="stylesheet" href ="leaflet/leaflet.css" />
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="leaflet/leaflet.js"></script>
  
<!-- Mapbox -->
    <script src="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js"> </script>
    <link href="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css" rel='stylesheet' />

<!--Tooltip-->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    
</head>

<body>

<!-- Primary Page Layout -->
<div class= "row">
    <div class= "wrapper">
        <div class= "two columns">
            <a class="button " href="/Users/Ruth/Desktop/Website/m/mSummary.html">SUMMARY MAP</a>
        </div>
        <div class= "ten columns">
            <a class="button" href="/Users/Ruth/Desktop/GAPmaps/m/mP65.html"> Percent 65+ </a>
            <a class="button " href="/Users/Ruth/Desktop/GAPmaps/m/mP80.html"> Percent 80+</a>
            <a class="button " href="/Users/Ruth/Desktop/GAPmaps/m/mSR65.html" data-toggle="tooltip" data-placement="bottom" title="Ratio between males 65+ and females 65+."> Sex Ratio 65+</a>
            <a class="button " href="/Users/Ruth/Desktop/GAPmaps/m/mSR80.html" data-toggle="tooltip" data-placement="bottom" title="Ratio between males 80+ and females 80+."> Sex Ratio 80+</a>
            <a class="button " href="/Users/Ruth/Desktop/GAPmaps/m/mSP65.html" data-toggle="tooltip" data-placement="bottom" title="Ratio between the population 65+ in the census division and the total population 65+ in Canada."> Share 65+</a>
            <a class="button " href="/Users/Ruth/Desktop/GAPmaps/m/mOCDR.html" data-toggle="tooltip" data-placement="bottom" title="Old Component of the Dependency Ratio is the ratio between the population 65+ and the population aged 15 to 64. "> OCDR</a>
        </div>
    </div>
</div>

<script>
    $(document).ready(function(){
                      $('[data-toggle="tooltip"]').tooltip();
                      });
</script>

<div id='legend' style='display:none;'>
    <nav class='legend clearfix'>
        <span style='background:#ffffff;'></span>
        <span style='background:#ccccff;'></span>
        <span style='background:#8080ff;'></span>
        <span style='background:#1a1aff;'></span>
        <span style='background:#0000b3;'></span>
        <label>0-55.6%</label>
        <label>55.6-59.4%</label>
        <label>59.4-63.3%</label>
        <label>63.3-69.0%</label>
        <label>69.0%+</label>
</div>

<div id ='map'></div>

<script src ="js/CDBoundary_simple.js"></script>

<script>
    // Setting up custom mapbox basemap
  
    L.mapbox.accessToken =
        'pk.eyJ1IjoicnV0aGhhbm5haCIsImEiOiJjaWh6MW1sc2MwNDZidWhrb2F3NjkwcmtmIn0.-kBXpXiYaLRbz7Km3UWwEg';
    
    var southWest = L.latLng(30, -145),
        northEast = L.latLng(85, -50),
        bounds = L.latLngBounds(southWest, northEast);
    
    var map= L.mapbox.map('map','ruthhannah.97be37d0',
                          {maxBounds: bounds,})
                          .setView([64.696, -100.986], 3);
 
   map.legendControl.addLegend(document.getElementById('legend').innerHTML);


    function getColor(d){
        return d> 69.020?'#0000b3':
        d> 63.360 ?'#1a1aff':
        d> 59.380 ?'#8080ff':
        d> 55.64  ?'#ccccff':
                   '#ffffff';
    }

    function style(feature){
        return {
            fillColor: getColor(feature.properties.SR80),
            weight: 0.3,
            opacity: 1,
            color: '#000000',
            dashArray: '',
            fillOpacity:0.7
        };
    }

    function highlightFeature(e){
        var layer = e.target;
            info.update(layer.feature.properties);
            layer.setStyle({
                           weight:0.7,
                           color: '#000000',
                           dashArray:'',
                           fillOpacity:0
                           });
                   
     if (!L.Browser.ie && !L.Browser.opera){
        layer.bringToFront();
     }
    }

    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    var geojson=L.geoJson(CDBoundary_simple,{
                      style:style,
                      onEachFeature: onEachFeature
                      }).addTo(map);
                      
     function zoomToFeature(e){
              map.fitBounds(e.target.getBounds());
              }

    function onEachFeature (feature, layer){
        layer.on({
             mouseover:highlightFeature,
             mouseout:resetHighlight,
             click:zoomToFeature
             });
    }

    // Summary Information Box
    var info = L.control();

    info.onAdd = function(map) {
        this._div = L.DomUtil.create('div','info');
        this.update();
        return this._div;
    };

    info.update = function(props) {
        this._div.innerHTML = (props? '<b> Province</b>: '+ props.PRNAME : "")
        + (props? '<br/><b>Census Division</b>: '+ props.CDNAME : "")
        + (props? '<br /><b>Sex ratio 80+:</b> ' + props.SR80.toFixed(2) + '%' : "");
        };

    info.addTo(map);

</script>

<!-- End Document -->
</body>
</html>
