<!DOCTYPE html>
<html lang="en">
<head>

<!-- Basic Page Needs -->
    <meta charset="utf-8">
    <title>GAP Summary Map</title>
    <meta name="description" content="">
    <meta name="author" content="">

<!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- FONT -->
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

<!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/m.css">

<!-- Favicon -->
    <link rel="icon" type="image/png" href="images/favicon.png">

<!-- Leaflet -->
    <link rel ="stylesheet" href ="leaflet/leaflet.css" />
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="leaflet/leaflet.js"></script>
  
<!-- Mapbox -->
    <script src="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js"> </script>
    <link href="https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css" rel='stylesheet' />

</head>

<body>

<!-- Primary Page Layout -->

<div class= "wrapper">
<a class="button" href="/Users/Ruth/Desktop/Website/m/mChoropleth.html">CHOROPLETH MAPS</a>
</div>

<div id ='map'></div>

<script src ="js/CDBoundary_simple.js"></script>

<script>
    
// Setting up custom mapbox basemap
    L.mapbox.accessToken =
        'pk.eyJ1IjoicnV0aGhhbm5haCIsImEiOiJjaWh6MW1sc2MwNDZidWhrb2F3NjkwcmtmIn0.-kBXpXiYaLRbz7Km3UWwEg';
    
    var southWest = L.latLng(30, -145),
        northEast = L.latLng(85, -50),
        bounds = L.latLngBounds(southWest, northEast);
    
    var map= L.mapbox.map('map','ruthhannah.97be37d0',
                          {maxBounds: bounds,})
                          .setView([64.696, -100.986], 3);
 

//Summary Map
    function style(feature){
        return {
            fillColor: '#FFFFFF',
            weight: 0.5,
            opacity: 1,
            color: '#000000',
            dashArray: '',
            fillOpacity:0.4
            };
        }


// Highlights census divisions
    function highlightFeature(e){
        var layer = e.target;
        info.update(layer.feature.properties);
        layer.setStyle({
            weight:1.2,
            color: '#1a1aff',
            dashArray:'',
            fillOpacity:0
            });
                   
            if (!L.Browser.ie && !L.Browser.opera){
                layer.bringToFront();
                }
    }

// Resets the census division highlight
    var geojson;
    
    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }

    function zoomToFeature(e){
        map.fitBounds(e.target.getBounds());
    }

// Adds listeners to layer so that census divisions are highlighted and reset
    function onEachFeature (feature, layer){
        layer.on({
             mouseover:highlightFeature,
             mouseout:resetHighlight,
             click:zoomToFeature
             });
    }

    var geojson=L.geoJson(CDBoundary_simple,{
                      style:style,
                      onEachFeature: onEachFeature
                      }).addTo(map);
                      
    var info = L.control();

    info.onAdd = function(map) {
        this._div = L.DomUtil.create('div','info');
        this.update();
        return this._div;
        };

    info.update = function(props) {
        this._div.innerHTML = (props? '<b> Province</b>: '+ props.PRNAME : "")
        + (props? '<br/><b>Census Division</b>: '+ props.CDNAME : "")
        + (props? '<br /><b>Percent of the population 65 and over: </b>' + props.P65.toFixed(2)+ '%' : "")
        + (props? '<br /><b>Percent of the population 80 and over: </b>' + props.P80.toFixed(2) + '%' : "")
        + (props? '<br /><b>Sex ratio 65 and over: </b>' + props.SR65.toFixed(2) + '%' : "")
        + (props? '<br /><b>Sex ratio 80 and over :</b> ' + props.SR80.toFixed(2) + '%' : "")
        + (props? '<br /><b>Share of the population 65 and over: </b>' + props.S65.toFixed(2) + '%': "")
        + (props? '<br /><b>Old component of the dependency ratio: </b>' + props.ODR.toFixed(2) + '%': "");
        };
    info.addTo(map);
    
</script>

<!-- End Document -->
</body>
</html>
